<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>All Print Orders | Admin</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 12px 15px;
        text-align: center;
        border: 1px solid #ddd;
        vertical-align: middle;
        word-break: break-word;
    }

    select, button {
        margin-top: 8px;
        padding: 5px 10px;
        font-size: 14px;
    }

    .status {
        font-weight: bold;
        padding: 5px 10px;
        border-radius: 5px;
        color: white;
        display: inline-block;
        white-space: nowrap;
    }

    .Pending {
        background-color: #ffc107;
    }

    .InProgress {
        background-color: #17a2b8;
    }

    .Ready {
        background-color: #28a745;
    }

    form {
        display: inline-block;
    }

    td form {
        display: flex;
        flex-direction: column;
        align-items: center;
    }
</style>
    
</head>
<body>

<h2>üìã All Print Orders</h2>

<table>
    <thead>
    <tr>
        <th>Order ID</th>
        <th>Student</th>
        <th>File</th>
        <th>Print Type</th>
        <th>Copies</th>
        <th>Status</th>
        <th>Change Status</th>
        <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="order : ${orders}">
        <td th:text="${order.orderId}">1001</td>
        <td th:text="|${order.user.name} (${order.user.email})|"></td>
        <td>
   <a th:href="@{/admin/download(fileName=${order.fileName})}" target="_blank" title="Download File">
    üì• <span th:text="${order.fileName}"></span>
</a>
</td>
        <td th:text="${order.printType}"></td>
        <td th:text="${order.numberOfCopies}"></td>
        <td>
    <span th:class="'status ' + 
                (${order.status} == 'Pending' ? 'Pending' : 
                 (${order.status} == 'In Progress' ? 'InProgress' : 'Ready'))"
          th:text="${order.status}"></span>
</td>
        <td>
    <form th:action="@{/admin/update-status}" method="post">
        <input type="hidden" name="orderId" th:value="${order.id}"/>
        <select name="status">
            <option value="Pending" th:selected="${order.status == 'Pending'}">Pending</option>
            <option value="In Progress" th:selected="${order.status == 'In Progress'}">In Progress</option>
            <option value="Ready for Pickup" th:selected="${order.status == 'Ready for Pickup'}">Ready for Pickup</option>
        </select>
        <button type="submit">Update</button>
    </form>
</td>
        <td>
            <form th:action="@{/admin/delete-order}" method="post" 
                  th:if="${order.status == 'Ready for Pickup'}" style="display:inline;">
                <input type="hidden" name="orderId" th:value="${order.id}" />
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="delete-btn" onclick="return confirm('Are you sure you want to delete this order?')">üóë Delete</button>
            </form>
        </td>
    </tr>
    </tbody>
</table>

<a th:href="@{/home}">‚Üê Back to Home</a>

</body>
</html>
